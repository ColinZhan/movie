function del(t,n,e){$.ajax({url:t+n,type:"DELETE"}).done(function(t){1===t.success&&swal("操作成功!","已成功删除数据！","success"),e()}).fail(function(){swal("网络错误！","删除失败，若长期删除失败，请联系管理员。","error")}).always(function(){console.log("完成。")})}function arrayToStr(t,n){var e=[];switch(n){case 0:return t?t.join(","):t;case 1:for(var a=0;a<=t.length-1;a++)e.push(t[a].name)}return e?e.join(","):e}function preview(t){var n=document.getElementById("preview");if(t.files&&t.files[0]){var e=new FileReader;e.onload=function(t){n.innerHTML=' <img style="width:120px" class="img-circle" src="'+t.target.result+'" /> '},e.readAsDataURL(t.files[0])}}function passvalue(n,e){for(t in{username:"/^[a-zA-Z0-9_-]{4,16}$/",pwd:"/^.*(?=.{6,})(?=.*d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&*? ]).*$/"})e==t&&alert(t)}function seterrorinput(t){$(t).parents(".form-group").addClass("has-error"),$(t).next("span").removeClass("hide")}function removeerrorinput(t){$(t).parents(".form-group").removeClass("has-error"),$(t).next("span").addClass("hide")}function beforesubmit(t){$(t).find("[val-type]").each(function(t,n){var e=$(n).val().trim(),a=$(n).data("val-type");null!=e&&""!=e&&null!=a&&""!=a&&passvalue(e,a)||seterrorinput($(n))})}$(function(){$('[data-toggle="tooltip"]').tooltip()}),$(function(){$(".comment").click(function(t){var n=$(this),e=n.data("tid"),a=n.data("cid");0<$("#toId").length?$("#toId").val(e):$("<input>").attr({type:"hidden",id:"toId",name:"comment[tid]",value:e}).appendTo("#commentForm"),0<$("#commentId").length?$("#commentId").val(a):$("<input>").attr({type:"hidden",id:"commentId",name:"comment[cid]",value:a}).appendTo("#commentForm")})}),$(function(){$(".del").click(function(t){var n=$(t.target),e=n.data("id"),a=window.location.pathname.toString()+"?id=";swal({title:"您确定要删除吗？",type:"warning",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"确定",confirmButtonColor:"#ec6c62"},function(){del(a,e,function(){$(n).parents("tr").hide("fast")})})}),$("#douban").blur(function(){var t=$(this).val();t&&$.ajax({url:"https://api.douban.com/v2/movie/subject/"+t,type:"GET",dataType:"jsonp",cache:!0,crossDomain:!0,jsonp:"callback"}).done(function(t){console.log("success"),console.log(t),$("#inputTitle").val(t.title),$("#inputDoctor").val(arrayToStr(t.directors,1)),$("#inputActor").val(arrayToStr(t.casts,1)),$("#inputCountry").val(arrayToStr(t.countries,0)),$("#inputLanguage").val(arrayToStr(t.languages,0)),$("#inputPoster").val(t.images.large),$("#inputYear").val(t.year),$("#inputSummary").val(t.summary)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})})}),$(function(){$('a[name="tab-lang"]').on("click",function(t){event.preventDefault();var n=$(this).attr("tab-area");$("#"+n).siblings().fadeOut("fast",function(){$("#"+n).fadeIn("fast")})})}),$(function(){$("#setRole").on("show.bs.modal",function(t){var n=$(this),e=$(t.relatedTarget),a=e.data("id"),o=e.data("role");n.find('input[type="hidden"]').val(a.trim());for(var i=n.find("select#role>option"),r=i.length-1;0<=r;r--)$(i[r]).val()==o?$(i[r]).attr("selected","true"):$(i[r]).removeAttr("selected")}),$("#setRole").on("hidden.bs.modal",function(t){$("form").find("input[ type='text'], input[ type='number'], input[ type='hidden']").val(""),$("select").find("option").removeAttr("selected")})}),$(function(){$("form#profile input").focus(function(t){$("#subprofile").fadeIn("fast")})}),$("form#signup").bind("submit",beforesubmit);